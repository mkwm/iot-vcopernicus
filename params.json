{"name":"vCopernicus","tagline":"Simple tool that makes it possible to write code for Internet of Things without actual things available","body":"# How it works\r\nThis tool is fairly simple. It consists of three parts written in Python:\r\n* management helper tool\r\n* coordinating webserver\r\n* serial port handler\r\n\r\nManagement helper tool allows to conveniently perform actions such as spawning new node or starting coordinating webserver.\r\n\r\nCoordinating webserver serves as \"hub\" for whole cluster of virtualized Copernicus devices - it provides both GUI for user input (buttons, motion, knob rotation) or presenting device state (LEDs, servo dashboard) and API for communicating between web browser (which serves as GUI client) and serial port handler.\r\n\r\nSerial port handler translates API events to serial port data and vice versa. There are several transport methods available.\r\n\r\nBoth webserver and handler make extensive use of HTML5 Server-Sent Events mechanism.\r\n\r\n# Requirements\r\nYou have to use virtualized device in the same way as with physical Copernicus in Mode 2 (via serial port). Mode 1 (direct GPIO access) is currently not supported, sorry.\r\n\r\n# Usage\r\nUse of Linux operating system is required (at the moment).\r\n\r\nFirst of all, you should create new Python 2.7 virtualenv. Installing vCopernicus system-wide is not recommended, as this requires superuser rights - also for updating already installed version. It also easier to completely remove virtualenv than to clean every bit of package installed system-wide.\r\n\r\nIf you use virtualenvwrapper, creating new virtualenv is as simple as writing:\r\n```\r\nmkvirtualenv -p /usr/bin/python2.7 vcopernicus\r\n```\r\n\r\nBefore using vCopernicus tools, you will need to enter virtualenv:\r\n```\r\nworkon vcopernicus\r\n```\r\n\r\nEntering virtualenv to run \"device code\" is not required - just make sure pySerial module is available and run your script as you would do on real Copernicus device (of course, you will need to specify proper virtual serial port path).\r\n\r\nYou don't have to run nodes and coordinating webserver on single machine (that means you don't have to install webserver module on node - and vice versa). Helper tool is common for both node and coordinator - it automatically detects available commands. If you want to use helper, install vCopernicus egg from this repository:\r\n```\r\npip install -e \"git+https://github.com/mkwm/iot-vcopernicus.git#egg=vCopernicus&subdirectory=vCopernicus\"\r\n```\r\n\r\nOn the nodes, you have to install vCopernicus-device egg:\r\n```\r\npip install -e \"git+https://github.com/mkwm/iot-vcopernicus.git#egg=vCopernicus-device&subdirectory=vCopernicus-device\"\r\n```\r\n\r\nSimilar command goes for coordinating webserver:\r\n```\r\npip install -e \"git+https://github.com/mkwm/iot-vcopernicus.git#egg=vCopernicus-coordinator&subdirectory=vCopernicus-coordinator\"\r\n```\r\n\r\n## Quick start\r\n1. Install all packages listed above\r\n2. Run\r\n   ```\r\n   vcopernicus start\r\n   vcopernicus create_node NODE\r\n   vcopernicus start_node NODE\r\n   ```\r\n   \r\n3. Write your code in ```NODE/home/code.py``` making use of already provided Serial object (variable ```serial```).\r\n4. Open web browser at [http://localhost:8080/devices/NODE](http://localhost:8080/devices/NODE)\r\n4. Run your code and have fun :)\r\n\r\n## Custom setup\r\n\r\n### Coordinating webserver\r\nIn order to start coordinating webserver, just invoke ```vcopernicus-coordinator``` command. You'll be able to see all currently registered devices at [http://localhost:8080/](http://localhost:8080/). Accessing [http://localhost:8080/devices/FOO](http://localhost:8080/devices/FOO) will create node named __FOO__. Now you can interact with virtual device like you do with physical one. You can also overlay scenario sheet image (320x480 pixels).\r\n\r\n### Serial port handler\r\nSerial port handler is started using command ```vcopernicus-device```. In order to use it, you need some serial port access/emulation method. In vCopernicus, such method is called transport. Each transport has its unique name and set of parameters. There are also some global parameters:\r\n- ```-c COORDINATOR```, ```--coordinator COORDINATOR``` - specifies coordinating webserver location; it defaults to ```IOT_HYPERVISOR``` environment variable or to ```localhost:8080``` if not set\r\n- ```-n NAME```, ```--name NAME``` - specifies node name; it defaults to ```IOT_NODENAME``` environment variable or to local hostname as returned by ```gethostname()``` call\r\n- ```TRANSPORT_TYPE``` - required; specifies which transport method would be used\r\n\r\nExample: to connect as node ```pusheen``` to coordinator ```drogon:5000``` and to use ```magic``` transport method, you should call:\r\n```\r\nvcopernicus-device -n pusheen -c drogon:5000 magic\r\n```\r\n\r\nAvailable transports and their specific arguments are described below.\r\n\r\n### Available transports\r\n\r\n#### File descriptor (FD) transport\r\nTransport which serves as base to other transports. It assumes that ```vcopernicus-device``` command would be provided with some already opened file descriptor, which should be used to communicate with device-side code.\r\n- ```-f FD_NUMBER```, ```--fd-number FD_NUMBER``` - file descriptor number\r\n\r\nDescribing how one can do this is beyound the scope of this documentation. In most cases, this transport method won't be used directly. Check PTY or UNIX socket transport instead.\r\n\r\n#### Pseudoterminal (PTY) transport\r\nThis method provides device-side code with pseudoterminal. They accept same ioctls as real serial ports do, so device code won't be able to see any difference. This is recommended method of running vCopernicus (if you are not running device operating system separately inside VirtualBox or VMware).\r\n- ```-p PTY_PATH```, ```--pty_path PTY_PATH``` - path of \"serial port\" to create; **WARNING:** if file with given path exists, it would be removed!\r\n\r\nExample:\r\n```\r\nvcopernicus-device pty -p /tmp/ttyS0\r\n```\r\n\r\n(Then, use ```Serial('/tmp/ttyS0')``` in your code)\r\n\r\n#### UNIX socket transport\r\nMethod dedicated for interaction with virtual machines which expose their serial port as UNIX socket (you'll find instructions how to set this up with VirtualBox or VMware below). It connects to specified socket as client, so it needs to be created by the other side first.\r\n- ```-p SOCKET_PATH```, ```--socket_path SOCKET_PATH``` - path of UNIX socket to connect to\r\n\r\nExample:\r\n```\r\nvcopernicus-device unix -p /tmp/vm_ttyS0.sock\r\n```\r\n\r\n##### VirtualBox VM\r\nYou can easily connect your virtual machine serial port to UNIX socket outside:\r\n\r\n1. Open your VM settings\r\n2. Choose \"Serial Ports\"\r\n3. Select \"Port 1\" tab (or \"Port 2\", if you need...)\r\n4. Check \"Enable Serial Port\"\r\n5. Select \"COM1\" as \"Port Number\" (you can choose different number, but you'll need to adjust serial port path in your code if you do so)\r\n6. Choose \"Host Pipe\" as \"Port Mode\"\r\n7. Tick checkbox next to \"Create Pipe\"\r\n8. Enter whatever path in \"Port/File Path\" - I suggest using something like ```/tmp/vm_ttyS0.sock```. Make sure you have write permission to this location and you remember it when running serial port handler!\r\n9. Click \"OK\"\r\n10. Start your VM\r\n\r\n##### VMware Player/Workstation\r\n**Note**: By default, VMware adds virtual printer to newly created virtual machines. This printer occupies first serial port. Make sure to change serial port name in your code or to remove virtual printer before following these steps:\r\n\r\n1. Open your VM settings\r\n2. Go to \"Hardware\" tab\r\n3. Click \"Add\" and select \"Serial Port\" when wizard appears\r\n4. When asked, select \"Output to socket\" as serial port type\r\n5. Enter whatever path in blank text input - I suggest using something like ```/tmp/vm_ttyS0.sock```. Make sure you have write permission to this location and you remember it when running serial port handler! Choose \"From Server\" and \"To An Application\".\r\n6. Click \"Finish\" to close wizard and \"Save\" to commit changes to your VM configuration.\r\n7. Start your VM\r\n\r\n# Bugs\r\nYes.\r\n\r\n# See also\r\n* [Copernicus](http://home.agh.edu.pl/~tszydlo/copernicus/) - platform for IoT classes by Tomasz Szydło and Robert Brzoza-Woch\r\n* [Copernicus API](https://github.com/gronostajo/copernicus-api) - convenient Python API for Copernicus by Krzysztof \"gronostaj\" Śmiałek\r\n\r\n# License\r\nvCopernicus itself is provided under the terms of [Creative Commons Attribution-NonCommercial 4.0 International](http://creativecommons.org/licenses/by-nc/4.0/) license.\r\n\r\n# External components\r\nvCopernicus includes jQuery, jQuery Knob and gauge.js, all of which are provided under the terms of MIT license:\r\n\r\n    The MIT License (MIT)\r\n   \r\n    jQuery: Copyright (c) jQuery Foundation and other contributors\r\n    jQuery Knob: Copyright (c) 2013 Anthony Terrien\r\n    gauge.js: Copyright (c) Bernard Kobos\r\n   \r\n    Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n    this software and associated documentation files (the \"Software\"), to deal in\r\n    the Software without restriction, including without limitation the rights to\r\n    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n    the Software, and to permit persons to whom the Software is furnished to do so,\r\n    subject to the following conditions:\r\n    \r\n    The above copyright notice and this permission notice shall be included in all\r\n    copies or substantial portions of the Software.\r\n    \r\n    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}